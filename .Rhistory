labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
geom_text(color="white", size=2) +
labs(title="Diverging Dot Plot",
subtitle="Normalized mileage from 'mtcars': Dotplot") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-2.5, 2.5) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-3, 3) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
ylim(-3, 3) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_y_continuous(limits=c(-5,5)) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
scale_y_continuous(limits=c(-5,5)) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-3, 3) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-10, 10) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_cartesian(ylim=c(-10,10))
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_cartesian(ylim=c(-10,10))+
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
coord_cartesian(ylim=c(-10,10))+
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
coord_cartesian(ylim=c(-10,10))+
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
limits = c(-5, 31)+
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
limits = c(0, 31)+
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-2.5, 2.5) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=status), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-2.5, 2.5) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-2.5, 2.5) +
coord_flip()
###########Mean  of students by state#######
df_mean_uf <- dfMedias %>%
group_by(UF) %>%
summarise(total=mean(value)) %>%
mutate(UF_completo = paste("BR", UF, sep="-"), z_score = scale(total), status = if_else(z_score > 0, '1', '0')) %>%
arrange(total)
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Mileage",
labels = c("Above Average", "Below Average"),
values = c("above"="#00ba38", "below"="#f8766d")) +
ylim(-2.5, 2.5) +
coord_flip()
###########Mean  of students by state#######
df_mean_uf <- dfMedias %>%
group_by(UF) %>%
summarise(total=mean(value)) %>%
mutate(UF_completo = paste("BR", UF, sep="-"), z_score = scale(total), status = if_else(z_score > 0, 1, 0)) %>%
arrange(total)
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
ylim(-2.5, 2.5) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
labs(fill = "Redes de ensino") +
xlab("Região") + ylab("Média") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) ++
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l=40, c=35) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(40, 35) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l=40, c=35) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l='#00ba38', c='#f8766d') +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status), colour= c('#00ba38', '#00ba38')), size=6) +
# scale_color_hue(l=40, c=35) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status), colour = c('#00ba38', '#00ba38')), size=6) +
# scale_color_hue(l=40, c=35) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l='green', c='red') +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l=miss, c=30) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l=10, c=30) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l=100 c=30) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_hue(l=100 ,  c=30) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(labels =  c("Above Average", "Below Average") ,values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Above mean", "Below mean") ,values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=10) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="black", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip(
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="black", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip(
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label = z_score)) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=6) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=2) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=4) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below mean", "Above mean") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below average", "Above average") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below average", "Above average") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Situação dos estados em relação a média de alunos por sala")
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Below average", "Above average") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala")
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala")
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
ylim(-4, 4) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala")
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
ylim(-3, 3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala")
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
ylim(-3, 3) +
xlab("States") + ylab("Z Factor") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
ylim(-3, 3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala")
coord_flip()
gvisGeoChart(df_mean_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
chart_geo_mean_alunos <- gvisGeoChart(df_mean_uf, locationvar = "UF_completo", colorvar = "total", hovervar = "UF",
options=list(region="BR",
displayMode="regions",
resolution="provinces",
width=800, height=800,
title='TESTING MAPS',
colorAxis="{colors:['#ccebff', '#005c99']}"))
plot(chart_geo_mean_alunos)
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
ylim(-3, 3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("States") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala") +
coord_flip()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("Estados") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala") +
coord_flip()
ggplot(df_approval_uf, aes(df_approval_uf$ensino,df_approval_uf$total, fill= df_approval_uf$UF)) +
geom_area()
###########Mean  of approval by state#######
df_approval_uf <- dfRendimento %>%
group_by(UF, ensino) %>%
filter( ensino == 'Total_aprovacao_fundamental' | ensino == 'Total_aprovacao_medio') %>%
summarise(total=mean(mean)) %>%
arrange(total)
ggplot(df_approval_uf, aes(df_approval_uf$ensino,df_approval_uf$total, fill= df_approval_uf$UF)) +
geom_area()
ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("Estados") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala") +
coord_flip()
chart_uf_zfactor = ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("Estados") + ylab("Z Factor") +
ggtitle("Estados em relação a média de alunos por sala") +
coord_flip()
plot(chart_uf_zfactor)
dfRendimento <- df3 %>%
dplyr::select(Ano, Rede, UF, Total_aprovacao_fundamental,Total_aprovacao_medio,
Total_reprovacao_fundamental, Total_reprovacao_medio,
Total_abandono_fundamental, Total_abandono_medio) %>%
filter( Rede == 'Estadual' | Rede == 'Municipal'| Rede == 'Particular') %>%
replace(., is.na(.), 0.0) %>%
gather(ensino, perc, Total_aprovacao_fundamental:Total_aprovacao_medio:Total_reprovacao_fundamental:Total_reprovacao_medio:
Total_abandono_fundamental:Total_abandono_medio)%>%
filter( perc > 0) %>%
group_by(Ano, Rede, UF, ensino) %>%
summarise(mean = mean(perc), median = median(perc)) %>%
arrange(mean)
##### Mean students per region #####
df_mean_region <- dfMedias %>%
group_by(Regiao) %>%
summarise(value=mean(value))
##### Mean students per region #####
df_mean_all <- dfMedias %>%
group_by(Regiao, ensino) %>%
summarise(value=mean(value))
######## mean of students at private/state/municipal #############
df_total_alunos_rede <- dfMedias %>%
group_by(Rede) %>%
summarise(cv=cv(value), value=mean(value))
###########Mean  of students by state#######
df_mean_uf <- dfMedias %>%
group_by(UF) %>%
summarise(total=mean(value)) %>%
mutate(UF_completo = paste("BR", UF, sep="-"), z_score = scale(total), status = if_else(z_score > 0, 1, 0)) %>%
arrange(total)
###########Mean  of approval by state#######
df_approval_uf <- dfRendimento %>%
group_by(UF, ensino) %>%
filter( ensino == 'Total_aprovacao_fundamental' | ensino == 'Total_aprovacao_medio') %>%
summarise(total=mean(mean)) %>%
arrange(total)
##### CHARTS ############
chart_media_regiao <- ggplot(df_mean_region, aes(x = df_mean_region$Regiao, y = df_mean_region$value, fill = factor(df_mean_region$Regiao))) +
geom_bar(stat = "identity", position=position_dodge()) +
scale_color_manual("Line", values = c('black'))+
labs(fill = "Redes de ensino") +
xlab("Região") + ylab("Média") +
ggtitle("Média de alunos por região do Brasil")
plot(chart_media_regiao)
chart_media_all <- ggplot(df_mean_all, aes(x = df_mean_all$Regiao, y = df_mean_all$value, fill = factor(df_mean_all$ensino))) +
geom_bar(stat = "identity", position=position_dodge()) +
labs(fill = "Ensino") +
xlab("Regiões do Brasil") + ylab("Média") +
ggtitle("Média de alunos por turma no ensino fundamental x médio x infantil no Brasil")
plot(chart_media_all)
chart_rede_total <- ggplot(df_total_alunos_rede, aes(x = df_total_alunos_rede$Rede, y = df_total_alunos_rede$value, fill = factor(df_total_alunos_rede$Rede))) +
geom_bar(stat = "identity", position=position_dodge()) +
geom_point(data=df_total_alunos_rede, aes(x = df_total_alunos_rede$Rede, y = df_total_alunos_rede$cv/5)) +
geom_line(data=df_total_alunos_rede, aes(x = df_total_alunos_rede$Rede, y = df_total_alunos_rede$cv/5, group = 1, colour='Coefficient of Variation'), size=1) +
geom_text(aes(x = df_total_alunos_rede$Rede, y= df_total_alunos_rede$cv/5 + 1, label = round(df_total_alunos_rede$cv, digits  = 2))) +
scale_color_manual("Line", values = c('black'))+
labs(fill = "Redes de ensino") +
xlab("Rede") + ylab("Média") +
ggtitle("Média de alunos por rede de ensino no Brasil")
plot(chart_rede_total)
chart_uf_zscore = ggplot(df_mean_uf, aes(x = reorder(UF, z_score), y = z_score, label =  round(z_score, digits  = 2))) +
geom_point(stat='identity', aes(col=factor(status)), size=8) +
scale_color_manual(name="Status", labels =  c("Abaixo da média", "Acima da média") ,values=c("#00ba38", "#f8766d")) +
geom_text(color="white", size=3) +
xlab("Estados") + ylab("Z Score") +
ggtitle("Estados em relação a média de alunos por sala") +
coord_flip()
plot(chart_uf_zscore)
